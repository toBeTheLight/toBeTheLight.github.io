---
layout: post
title:  "Gulp搭建多页面工作环境"
categories: Gulp
tags:  jekyll 
---

* content
{:toc}
使用Gulp构建前端开发环境，适用于多静态页的项目。
主要完成Less与ES6的编译，代码压缩，雪碧图生成、js语法检查与实时刷新。
主要运用了现成的gulp插件并对个别插件代码进行修改以满足个人需求。
首先默认已安装了**node**与**npm**，且已熟悉相关用法。



## 初始化项目 ##
### 创建package.json ###
执行
`npm init`
引导创建一个package.json文件，用来保存项目配置信息与模块依赖。
### 创建目录结构 ###
    dev
    |--- css 
    |--- img
    |--- js
    dist
    |--- css
    |--- img
    |--- js
    src
    |--- less
    |--- img
    |--- js
src中为原始代码
dist中为gulp构建代码

## 安装gulp与相关插件 ##
### 安装gulp ###

我们要将gulp安装两次
首先进行全局安装
`npm install -g`
再切换至项目目录
`npm install gulp --save-dev`

### 此时进行所有功能依赖查件的安装 ###

可根据package.json进行`npm install`

列举部分插件：
编译Less文件（gulp-less）
添加css前缀（gulp-autoprefixer）
压缩css（gulp-minify-css）
js代码校验（gulp-jshint）
ES6代码编译（gulp-babel、babel-preset-es2015）
合并js文件（gulp-concat）
压缩js代码（gulp-uglify）
雪碧图生成（gulp-css-spriter）
压缩图片（gulp-imagemin）
自动刷新页面（gulp-livereload）
图片缓存（gulp-cache）
任务提醒（gulp-notify）

## 建立任务 ##
### 创建gulpfile.js ###
在根目录下创建gulpfile.js
### 加载插件 ###
在gulpfile.js中编写
```js
var gulp = require('gulp'),
    //less的编译
    less = require('gulp-less'),
    //雪碧图合成
    sprite = require('gulp-css-spriter'),
    //自动添加css前缀
    autoprefixer = require('gulp-autoprefixer'),
    //压缩css
    minifycss = require('gulp-minify-css'),
    //js代码校验
    jshint = require('gulp-jshint'),
    //ES6代码编译
    babel = require('gulp-babel'),
    //压缩js代码
    uglify = require('gulp-uglify'),
    //图片压缩
    imagemin = require('gulp-imagemin'),
    rename = require('gulp-rename'),
    //合并js文件
    concat = require('gulp-concat'),
    //更改提醒
    notify = require('gulp-notify'),
    cache = require('gulp-cache'),
    //自动刷新页面
    livereload = require('gulp-livereload');
```
由于除了gulp插件以外，其他的插件需要分别加载比较麻烦，我们可以使用gulp-load-plugins插件来一次性加载所有package.json中所有gulp插件，用法如下。
```js
var gulpLoadPlugins = require('gulp-load-plugins'),
	plugins = gulpLoadPlugins();
//此时所有的gulp插件都可以以下方式调用
	plugins.jshint();
	plugins.uglify();
```
### 