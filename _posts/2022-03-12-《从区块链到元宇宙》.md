---
layout: post
title:  "阅读：《认知觉醒》"
categories: 阅读笔记
tags:  方法论 心理学
author: toBeTheLight
---

* content
{:toc}








# 区块链

P2P 账本，每一个节点都会向周围节点广播记账信息，在 POW 机制（工作量证明，还有其他如 POS、DPOS 机制）下，一些节点争夺记账权限，将收到的记账信息计算为新的区块，广播至周围节点，其它节点校验并接受后追加到链上。

区块链数据结构：区块+链。

* 区块：
    * 区块头：负责基本功能，包含上个区块的哈希和当前区块的哈希
    * 区块体：实际数据，即账本信息
* 链：新的区块追加到旧的区块后面

同时由于新区块有上个区块的信息，形成了有内容关联的链。

## 比特币

https://www.youtube.com/watch?v=obRzfcvMshM&feature=youtu.be

交易信息示例：
```utxo
In:
Previous tx: f5d8ee39a430901c91a5917b9f2dc19d6d1a0e9cea205b009ca73dd0
4470b9a6
Index: 0
// Previous tx + Index 指向资金来源记录的 Out
scriptSig: 304502206e21798a42fae0e854281abd38bacd1aeed3ee3738d9e1446
618c4571d1090db022100e2ac980643b0b82c0e88ffdfec6b64e3e6ba35e7ba5fd
d7d5d6cc8d25c6b241501
// scriptSig 需要可解资金来源记录的 scriptPubKey

Out:
Value: 5000000000
scriptPubKey: OP_DUP OP_HASH160 404371705fa9bd789a2fcd52d2c580b65d35
549d OP_EQUALVERIFY OP_CHECKSIG 
// 即解锁脚本，下一个交易的 scriptSig 使得 scriptPubKey 通过则可使用此笔交易
```
* 记账信息确权：见 UTXO
    * 发送节点记账信息包含
        * 多个（资金来源）的记账引用
        * 多个解锁脚本签名（签名+公钥）
    * 接收节点：
        * 将解锁签名和记账引用的锁定脚本（有地址信息）执行通过后即解锁
        * 即确定当前公钥提供者有记账转出地址的所有权
* 记账信息防伪：
    * 发送节点：
        * 将内容哈希得到摘要
        * 用私钥对摘要加密生成签名
        * 将内容和签名进行广播
    * 接收节点：
        * 使用发送节点记账信息中的公钥对签名解密得到摘要 1
        * 对内容进行哈希，得到摘要 2
        * 摘要 1 等于摘要 2 则内容可信
2. 每笔记账以之前的记账为基础，信息需要满足输入等于输出
    * 示例：A 账号要支付 6 比特币给 D 账号，则记账数据写为：
        * 输入：B 账号支付 2 比特币给 A 账号 + C 账号支付 3 比特币给 A 账号 + D 账号支付 2 比特币给 A 账号
        * 输出：支付 6 比特币给 D 账号 + 支付 1 比特币给 A 账号
    * 特点：
        * 需要说明支出来源（也可直接指向某历史支出）
        * 记账无法拆分，以找零形式（即支付给自己）弥补数额的不匹配
3. 记录的分布式存储、一致性、维护：
    * 分布式：网络上很多节点进行存储和数据认证
    * 有效性：如某账号同时发送了多条矛盾的记账记录
        * 矿工将多条记账记录校验后制作为新的区块
    * 一致性：由广播的机制，短时间内矿工们收到即记账信息可能不同，这会造成最终生成的区块信息不一致
        * 使用规则使得单位时间内（约10分钟）只有一个矿工能将自己的区块发布到网络上
        * 规则：
            1. 新区块的内容（前一个区块的SHA-256 + 这个区块的基本信息 + 新区块的记账记录）组合成字符串
            2. 在新区块字符串的末尾加上一个随机数，进行SHA-256，如果结果的二进制前72位全是0则工作完成
        * 所以挖矿需要大量的算力（电力）
        * 矿工收入：比特币网络奖励和区块中的记账手续费
    * 分叉：凑巧同时生成了两个区块，在后续计算中采用最长链原则，废弃未追加区块的分叉
    * 篡改：需要有超高的算力，篡改者的算力需要超过整个网络的算力才能实现篡改
* 数字货币发行：在新生成区块中可写入对自己进行支付的系统奖励记账信息，此奖励每过 21 万个区块减半

### 总结

1. 使用 SHA-256算法和非对称加密制作数字签名
2. 使用区块链的区块存储比特币记账记录
3. 利用额外的工作规则达成网络一致性（拼算力）
4. 将网络奖励和记账手续费支付给矿工节点

## 以太坊

一种平台，可编程的区块链。去中心化应用，智能合约。

## 其他

* 空块：在部分区块链中，新区块产生后，会先广播区块头再广播区块体，由于区块体数据较大，下载需要时间，部分矿工节点会在收到区块头后就开始挖矿，由于向新区块体中写入的记账信息不能与已有区块冲突或重复，所以为保证在未拿到前一区块信息的情况下的新区块的有效性，不向新区块体中写入实际记账信息（奖励信息除外），从而产生空块。